{"version":3,"file":"home.bundle.js","sources":["../pages/home.js"],"sourcesContent":["\r\n/**********************************************************\r\nProduct search form\r\n**********************************************************/\r\nconst eFormProductSearch = {\r\n    form: '#product-search-form',\r\n\r\n    inputs: {\r\n        location: '#product-search-form-input-location',\r\n        dates: '#product-search-form-input-dates',\r\n        category: '#product-search-form-input-category',\r\n    },\r\n\r\n    dropdownDataAttr:'data-product-category-sub-id',\r\n    subCategoryDataAttr: 'data-category-sub-id',\r\n\r\n    classes: {\r\n        input: '.product-search-form-input',\r\n    },\r\n\r\n    dateRangesFlatpick: null,\r\n\r\n    buttons: {\r\n        search: '#product-search-form-button-search',\r\n    },\r\n\r\n    dropdownText: '#product-search-form-input-category-text',\r\n\r\n    getInputValues: function() {\r\n        let values = {};\r\n        \r\n        // location\r\n        values.location_id = $(eFormProductSearch.inputs.location).val();\r\n\r\n        // date range\r\n        const dates = eFormProductSearch.dateRangesFlatpick.getDateValues();\r\n        values.starts_on = dates.startsOn;\r\n        values.ends_on = dates.endsOn;\r\n        \r\n        \r\n        values.product_categories_sub_id = eFormProductSearch.getProductCategorySubId();\r\n\r\n        return values;\r\n    },\r\n\r\n    getProductCategorySubId: function() {\r\n        const result = $(eFormProductSearch.inputs.category).attr(eFormProductSearch.dropdownDataAttr);\r\n        return parseInt(result);\r\n    },\r\n}\r\n\r\nlet eLocationInput = null;\r\n\r\n\r\n/**********************************************************\r\nMain logic\r\n**********************************************************/\r\n$(document).ready(function() {\r\n    loadPlugins();\r\n    setEventListeners();\r\n});\r\n\r\n\r\n/**********************************************************\r\nLoads all of the js plugins\r\n**********************************************************/\r\nfunction loadPlugins() {\r\n    eLocationInput = LocationsSelect.init(eFormProductSearch.inputs.location, 'Location', 3);\r\n    eFormProductSearch.dateRangesFlatpick = new FlatpickrRange(eFormProductSearch.inputs.dates, true);\r\n    loadCategories();\r\n}\r\n\r\n/**********************************************************\r\nRegisters all of the event handlers\r\n**********************************************************/\r\nfunction setEventListeners() {\r\n    // product search category input change\r\n    $(eFormProductSearch.inputs.category).on('click', '.dropdown-item', function() {\r\n        handleProductSearchCategoryChange(this);\r\n    });\r\n\r\n    $(eFormProductSearch.buttons.search).on('click', function() {\r\n        gotoSearchProductsPage();\r\n    });\r\n\r\n    $(eFormProductSearch.classes.input).on('change', function() {\r\n        inputValueChange(this);\r\n    });\r\n}\r\n\r\n\r\n\r\n/**********************************************************\r\nHandler for when the product search category input is changed.\r\n**********************************************************/\r\nfunction handleProductSearchCategoryChange(eDropdownItem) {\r\n    // set it to active in the dropdown menu\r\n    $(eFormProductSearch.inputs.category).find('.dropdown-item').removeClass('active');\r\n    $(eDropdownItem).addClass('active');\r\n\r\n    // set the dropdown data attribute to the id of the sub category selected\r\n    const subCategoryID = $(eDropdownItem).attr(eFormProductSearch.subCategoryDataAttr);\r\n    $(eFormProductSearch.inputs.category).attr(eFormProductSearch.dropdownDataAttr, subCategoryID);\r\n\r\n    // show the name\r\n    const subCategoryName = $(eDropdownItem).text();\r\n    $(eFormProductSearch.dropdownText).text(subCategoryName);\r\n}\r\n\r\n/**********************************************************\r\nFetch the product category data from the API.\r\n**********************************************************/\r\nfunction loadCategories() {\r\n    ApiWrapper.requestGetProductCategories(loadCategoriesSuccess, loadCategoriesError);\r\n}\r\n\r\n/**********************************************************\r\nCallback for an unsuccessful fetch of the product categories (loadCategories)\r\n**********************************************************/\r\nfunction loadCategoriesError(xhr, status, error) {\r\n    console.error('Error: loadCategoriesError')\r\n    console.error(xhr);\r\n    console.error(status);\r\n    console.error(error);\r\n}\r\n\r\n/**********************************************************\r\nCallback for a successful fetch of the product categories (loadCategories)\r\n**********************************************************/\r\nfunction loadCategoriesSuccess(result,status,xhr) {\r\n    const categories = genertateMinorCategoryMap(result);\r\n    let minors = sortCategories(categories);\r\n    let html = generateCategorieshDropdownHtml(minors);\r\n\r\n    $(eFormProductSearch.inputs.category).find('.dropdown-menu').html(html);\r\n}\r\n\r\n/**********************************************************\r\nTransforms a list of product category objects into a map:\r\n    key = minor category id\r\n    value = object(name, subs: [])\r\n**********************************************************/\r\nfunction genertateMinorCategoryMap(categoriesTableList) {\r\n    let minors = {};\r\n\r\n    // break down the categories into a map of minor categories with an empty list for the sub categories\r\n    for (const cat of categoriesTableList) {\r\n        minors[cat.minor_id] = {\r\n            name: cat.minor_name,\r\n            subs: [],\r\n        }\r\n    }\r\n\r\n    // insert all the sub categories into the sub category list\r\n    for (const cat of categoriesTableList) {\r\n        const sub = {\r\n            id: cat.sub_id,\r\n            name: cat.sub_name,\r\n        }\r\n        minors[cat.minor_id].subs.push(sub);\r\n    }\r\n\r\n    return minors;\r\n}\r\n\r\n/**********************************************************\r\nSorts the list of product categories by Minor, Sub category.\r\n\r\nThis doesn't really do anything right now...\r\n**********************************************************/\r\nfunction sortCategories(unsortedCategories) {\r\n    return unsortedCategories;\r\n}\r\n\r\n\r\n\r\n/**********************************************************\r\nGenerates the dropdown menu html for the #product-search-form-input-category.\r\nThe input is a \"minor product category\" map generated by genertateMinorCategoryMap.\r\n**********************************************************/\r\nfunction generateCategorieshDropdownHtml(minorCategoriesMap) {\r\n    let html = '';\r\n\r\n    for (const minorID of Object.keys(minorCategoriesMap)) {\r\n        const minorName = minorCategoriesMap[minorID].name;\r\n\r\n        html += `<div class=\"header-section\">`;\r\n        html += `<h6 class=\"dropdown-header\">${minorName}</h6>`;\r\n        \r\n        // generate the html of the sub categories\r\n        for (const sub of minorCategoriesMap[minorID].subs) {\r\n            html += getSubCategoryDropdownHtml(sub.id, sub.name);\r\n        }\r\n\r\n        html += `<div class=\"dropdown-divider\"></div>`;\r\n        html += `</div\">`;\r\n    }\r\n\r\n    return html;\r\n}\r\n\r\n/**********************************************************\r\nGenerates the dropdown menu item html for a single sub category.\r\n**********************************************************/\r\nfunction getSubCategoryDropdownHtml(id, name) {\r\n    let html = `<button class=\"dropdown-item\" type=\"button\" data-category-sub-id=\"${id}\">${name}</button>`;\r\n    return html;\r\n}\r\n\r\n\r\n/**********************************************************\r\nCreates the search page url and then loads the page\r\n**********************************************************/\r\nfunction gotoSearchProductsPage() {\r\n    const searchInputValues = eFormProductSearch.getInputValues();\r\n\r\n    if (searchInputValues.ends_on == null) {\r\n        return;\r\n    } else if (searchInputValues.starts_on == null) {\r\n        return;\r\n    } else if (searchInputValues.location_id == \"\" || searchInputValues.location_id == null) {\r\n        return;\r\n    }\r\n\r\n    let urlQueryParms = `location_id=${searchInputValues.location_id}&starts_on=${searchInputValues.starts_on}&ends_on=${searchInputValues.ends_on}`;\r\n\r\n    let newUrl = `/search/products`;\r\n    if (searchInputValues.product_categories_sub_id > 0) {\r\n        // append the sub product category if they selected one\r\n        newUrl += `/categories/minor/${searchInputValues.product_categories_sub_id}`;\r\n    }\r\n\r\n    window.location.href = `${newUrl}?${urlQueryParms}`;\r\n}\r\n\r\n\r\n/**********************************************************\r\nWhen an input value is changed, check if the search button\r\ncan be enabled. \r\n\r\nThe dates and location inputs all need a value in order to\r\nsearch for a product.\r\n**********************************************************/\r\nfunction inputValueChange(eChangedInput) {\r\n    const searchInputValues = eFormProductSearch.getInputValues();\r\n\r\n    if (Object.values(searchInputValues).includes(null)) {\r\n        $(eFormProductSearch.buttons.search).prop('disabled', true);\r\n    } else {\r\n        $(eFormProductSearch.buttons.search).prop('disabled', false);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"],"names":[],"mappings":"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"}